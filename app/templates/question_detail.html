{% extends 'base.html' %}

{% block title %}Question Detail - Planq{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
    <div class="p-6">
        <div class="flex justify-between items-start mb-4">
            <h1 class="text-2xl font-bold text-primary-600 dark:text-primary-400">{{ question.title }}</h1>
            <div class="flex items-center">
                <span class="inline-block px-2 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 text-xs rounded">
                    {{ question.difficulty }}
                </span>
            </div>
        </div>
        
        <p class="text-gray-700 dark:text-gray-300 mb-6">{{ question.content }}</p>
        
        <div class="mb-8">
            <h2 class="text-lg font-semibold mb-2">Options:</h2>
            <div class="space-y-2" x-data="{ selected: null, isCorrect: false, isSubmitted: false }">
                {% for option in question.options %}
                <div class="flex items-center p-3 border rounded-md"
                     :class="{ 
                         'bg-gray-100 dark:bg-gray-700': selected === {{ loop.index0 }} && !isSubmitted,
                         'bg-green-100 dark:bg-green-900 border-green-500': isSubmitted && '{{ option }}' === '{{ question.correct_answer }}',
                         'bg-red-100 dark:bg-red-900 border-red-500': isSubmitted && selected === {{ loop.index0 }} && '{{ option }}' !== '{{ question.correct_answer }}'
                     }">
                    <input type="radio" 
                           id="option{{ loop.index }}" 
                           name="answer" 
                           value="{{ loop.index0 }}"
                           @click="selected = {{ loop.index0 }}"
                           :disabled="isSubmitted"
                           class="mr-2">
                    <label for="option{{ loop.index }}">{{ option }}</label>
                </div>
                {% endfor %}
                
                <div class="mt-4">
                    <button @click="isSubmitted = true; isCorrect = (selected !== null && '{{ question.options[0] }}' === '{{ question.correct_answer }}')"
                            :disabled="selected === null || isSubmitted"
                            class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded disabled:opacity-50">
                        Submit Answer
                    </button>
                    
                    <div x-show="isSubmitted" x-cloak class="mt-4 p-3 rounded-md" :class="isCorrect ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200' : 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200'">
                        <p x-text="isCorrect ? 'Correct! Well done!' : 'Incorrect. The correct answer is {{ question.correct_answer }}'"></p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="flex flex-wrap gap-2 mb-6">
            {% for tag in question.tags %}
            <span class="px-2 py-1 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 text-sm rounded">{{ tag }}</span>
            {% endfor %}
        </div>
        
        <div class="flex justify-between">
            <a href="{{ url_for('questions.list') }}" class="inline-block px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded">
                Back to Questions
            </a>
            <button class="inline-block px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded">
                Next Question
            </button>
        </div>
    </div>
</div>
{% endblock %}
